<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="hive函数大全

目录一、关系运算：    4

等值比较: =    4
不等值比较: &amp;lt;&amp;gt;    4
小于比较: &amp;lt;    4
小于等于比较: &amp;lt;=    4
大于比较: &amp;gt;    5
大于等于比较: &amp;gt;=    5
空值判断: IS NULL    5
非空判断: IS NOT NULL    6
LIKE比较: LIKE    6
JAVA的LIKE操">
<meta property="og:type" content="article">
<meta property="og:title" content="hive函数大全">
<meta property="og:url" content="http://crystal564.github.io/2017/04/18/2017-04-18-hive-function/index.html">
<meta property="og:site_name" content="crystal564的博客">
<meta property="og:description" content="hive函数大全

目录一、关系运算：    4

等值比较: =    4
不等值比较: &amp;lt;&amp;gt;    4
小于比较: &amp;lt;    4
小于等于比较: &amp;lt;=    4
大于比较: &amp;gt;    5
大于等于比较: &amp;gt;=    5
空值判断: IS NULL    5
非空判断: IS NOT NULL    6
LIKE比较: LIKE    6
JAVA的LIKE操">
<meta property="og:updated_time" content="2017-04-18T06:43:14.969Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="hive函数大全">
<meta name="twitter:description" content="hive函数大全

目录一、关系运算：    4

等值比较: =    4
不等值比较: &amp;lt;&amp;gt;    4
小于比较: &amp;lt;    4
小于等于比较: &amp;lt;=    4
大于比较: &amp;gt;    5
大于等于比较: &amp;gt;=    5
空值判断: IS NULL    5
非空判断: IS NOT NULL    6
LIKE比较: LIKE    6
JAVA的LIKE操">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://crystal564.github.io/2017/04/18/2017-04-18-hive-function/"/>





  <title> hive函数大全 | crystal564的博客 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">crystal564的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">每天进步一点点</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://crystal564.github.io/2017/04/18/2017-04-18-hive-function/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="crystal564">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="crystal564的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                hive函数大全
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-18T14:34:03+08:00">
                2017-04-18
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/04/18/2017-04-18-hive-function/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/04/18/2017-04-18-hive-function/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/04/18/2017-04-18-hive-function/" class="leancloud_visitors" data-flag-title="hive函数大全">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>hive函数大全</p>
<!--hive-->
<p>目录<br>一、关系运算：    4</p>
<ol>
<li>等值比较: =    4</li>
<li>不等值比较: &lt;&gt;    4</li>
<li>小于比较: &lt;    4</li>
<li>小于等于比较: &lt;=    4</li>
<li>大于比较: &gt;    5</li>
<li>大于等于比较: &gt;=    5</li>
<li>空值判断: IS NULL    5</li>
<li>非空判断: IS NOT NULL    6</li>
<li>LIKE比较: LIKE    6</li>
<li>JAVA的LIKE操作: RLIKE    6</li>
<li>REGEXP操作: REGEXP    7<br>二、数学运算：    7</li>
<li>加法操作: +    7</li>
<li>减法操作: -    7</li>
<li>乘法操作: *    8</li>
<li>除法操作: /    8</li>
<li>取余操作: %    8</li>
<li>位与操作: &amp;    9</li>
<li>位或操作: |    9</li>
<li>位异或操作: ^    9<br>9．位取反操作: ~    10<br>三、逻辑运算：    10</li>
<li>逻辑与操作: AND    10</li>
<li>逻辑或操作: OR    10</li>
<li>逻辑非操作: NOT    10<br>四、数值计算    11</li>
<li>取整函数: round    11</li>
<li>指定精度取整函数: round    11</li>
<li>向下取整函数: floor    11</li>
<li>向上取整函数: ceil    12</li>
<li>向上取整函数: ceiling    12</li>
<li>取随机数函数: rand    12</li>
<li>自然指数函数: exp    13</li>
<li>以10为底对数函数: log10    13</li>
<li>以2为底对数函数: log2    13</li>
<li>对数函数: log    13</li>
<li>幂运算函数: pow    14</li>
<li>幂运算函数: power    14</li>
<li>开平方函数: sqrt    14</li>
<li>二进制函数: bin    14</li>
<li>十六进制函数: hex    15</li>
<li>反转十六进制函数: unhex    15</li>
<li>进制转换函数: conv    15</li>
<li>绝对值函数: abs    16</li>
<li>正取余函数: pmod    16</li>
<li>正弦函数: sin    16</li>
<li>反正弦函数: asin    16</li>
<li>余弦函数: cos    17</li>
<li>反余弦函数: acos    17</li>
<li>positive函数: positive    17</li>
<li>negative函数: negative    17<br>五、日期函数    18</li>
<li>UNIX时间戳转日期函数: from_unixtime    18</li>
<li>获取当前UNIX时间戳函数: unix_timestamp    18</li>
<li>日期转UNIX时间戳函数: unix_timestamp    18</li>
<li>指定格式日期转UNIX时间戳函数: unix_timestamp    18</li>
<li>日期时间转日期函数: to_date    19</li>
<li>日期转年函数: year    19</li>
<li>日期转月函数: month    19</li>
<li>日期转天函数: day    19</li>
<li>日期转小时函数: hour    20</li>
<li>日期转分钟函数: minute    20</li>
<li>日期转秒函数: second    20</li>
<li>日期转周函数: weekofyear    20</li>
<li>日期比较函数: datediff    21</li>
<li>日期增加函数: date_add    21</li>
<li>日期减少函数: date_sub    21<br>六、条件函数    21</li>
<li>If函数: if    21</li>
<li>非空查找函数: COALESCE    22</li>
<li>条件判断函数：CASE    22</li>
<li>条件判断函数：CASE    22<br>七、字符串函数    23</li>
<li>字符串长度函数：length    23</li>
<li>字符串反转函数：reverse    23</li>
<li>字符串连接函数：concat    23</li>
<li>带分隔符字符串连接函数：concat_ws    23</li>
<li>字符串截取函数：substr,substring    24</li>
<li>字符串截取函数：substr,substring    24</li>
<li>字符串转大写函数：upper,ucase    24</li>
<li>字符串转小写函数：lower,lcase    25</li>
<li>去空格函数：trim    25</li>
<li>左边去空格函数：ltrim    25</li>
<li>右边去空格函数：rtrim    25</li>
<li>正则表达式替换函数：regexp_replace    26</li>
<li>正则表达式解析函数：regexp_extract    26</li>
<li>URL解析函数：parse_url    26</li>
<li>json解析函数：get_json_object    27</li>
<li>空格字符串函数：space    27</li>
<li>重复字符串函数：repeat    27</li>
<li>首字符ascii函数：ascii    28</li>
<li>左补足函数：lpad    28</li>
<li>右补足函数：rpad    28</li>
<li>分割字符串函数: split    28</li>
<li>集合查找函数: find_in_set    29<br>八、集合统计函数    29</li>
<li>个数统计函数: count    29</li>
<li>总和统计函数: sum    29</li>
<li>平均值统计函数: avg    30</li>
<li>最小值统计函数: min    30</li>
<li>最大值统计函数: max    30</li>
<li>非空集合总体变量函数: var_pop    30</li>
<li>非空集合样本变量函数: var_samp    31</li>
<li>总体标准偏离函数: stddev_pop    31</li>
<li>样本标准偏离函数: stddev_samp    31<br>10．中位数函数: percentile    31</li>
<li>中位数函数: percentile    31</li>
<li>近似中位数函数: percentile_approx    32</li>
<li>近似中位数函数: percentile_approx    32</li>
<li>直方图: histogram_numeric    32<br>九、复合类型构建操作    32</li>
<li>Map类型构建: map    32</li>
<li>Struct类型构建: struct    33</li>
<li>array类型构建: array    33<br>十、复杂类型访问操作    33</li>
<li>array类型访问: A[n]    33</li>
<li>map类型访问: M[key]    34</li>
<li>struct类型访问: S.x    34<br>十一、复杂类型长度统计函数    34</li>
<li>Map类型长度函数: size(Map<k.v>)    34</k.v></li>
<li>array类型长度函数: size(Array<t>)    34</t></li>
<li>类型转换函数    35</li>
</ol>
<p>一、关系运算：</p>
<ol>
<li><p>等值比较: =<br>语法：A=B<br>操作类型：所有基本类型<br>描述: 如果表达式A与表达式B相等，则为TRUE；否则为FALSE<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hive&gt; select 1 from lxw_dual where 1=1;</div></pre></td></tr></table></figure>
</li>
<li><p>不等值比较: &lt;&gt;</p>
</li>
</ol>
<p>语法: A &lt;&gt; B<br>操作类型: 所有基本类型<br>描述: 如果表达式A为NULL，或者表达式B为NULL，返回NULL；如果表达式A与表达式B不相等，则为TRUE；否则为FALSE<br>举例：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hive&gt; select 1 from lxw_dual where 1 &lt;&gt; 2;</div></pre></td></tr></table></figure></p>
<ol>
<li><p>小于比较: &lt;<br>语法: A &lt; B<br>操作类型: 所有基本类型<br>描述: 如果表达式A为NULL，或者表达式B为NULL，返回NULL；如果表达式A小于表达式B，则为TRUE；否则为FALSE<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hive&gt; select 1 from lxw_dual where 1 &lt; 2;</div></pre></td></tr></table></figure>
</li>
<li><p>小于等于比较: &lt;=<br>语法: A &lt;= B<br>操作类型: 所有基本类型<br>描述: 如果表达式A为NULL，或者表达式B为NULL，返回NULL；如果表达式A小于或者等于表达式B，则为TRUE；否则为FALSE<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hive&gt; select 1 from lxw_dual where 1 &lt;= 1;</div></pre></td></tr></table></figure>
</li>
<li><p>大于比较: &gt;<br>语法: A &gt; B<br>操作类型: 所有基本类型<br>描述: 如果表达式A为NULL，或者表达式B为NULL，返回NULL；如果表达式A大于表达式B，则为TRUE；否则为FALSE<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hive&gt; select 1 from lxw_dual where 2 &gt; 1;</div></pre></td></tr></table></figure>
</li>
<li><p>大于等于比较: &gt;=<br>语法: A &gt;= B<br>操作类型: 所有基本类型<br>描述: 如果表达式A为NULL，或者表达式B为NULL，返回NULL；如果表达式A大于或者等于表达式B，则为TRUE；否则为FALSE<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">hive&gt; select 1 from lxw_dual where 1 &gt;= 1;</div><div class="line">--注意：String的比较要注意(常用的时间比较可以先to_date之后再比较)</div><div class="line">hive&gt; select * from lxw_dual;</div><div class="line">OK</div><div class="line">2011111209 00:00:00     2011111209</div><div class="line"></div><div class="line">hive&gt; select a,b,a&lt;b,a&gt;b,a=b from lxw_dual;</div><div class="line">2011111209 00:00:00     2011111209      false   true    false</div></pre></td></tr></table></figure>
</li>
<li><p>空值判断: IS NULL<br>语法: A IS NULL<br>操作类型: 所有类型<br>描述: 如果表达式A的值为NULL，则为TRUE；否则为FALSE<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hive&gt; select 1 from lxw_dual where null is null;</div></pre></td></tr></table></figure>
</li>
<li><p>非空判断: IS NOT NULL<br>语法: A IS NOT NULL<br>操作类型: 所有类型<br>描述: 如果表达式A的值为NULL，则为FALSE；否则为TRUE<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hive&gt; select 1 from lxw_dual where 1 is not null;</div></pre></td></tr></table></figure>
</li>
<li><p>LIKE比较: LIKE<br>语法: A LIKE B<br>操作类型: strings<br>描述: 如果字符串A或者字符串B为NULL，则返回NULL；如果字符串A符合表达式B   的正则语法，则为TRUE；否则为FALSE。B中字符”_”表示任意单个字符，而字符”%”表示任意数量的字符。<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">hive&gt; select 1 from lxw_dual where 'football' like 'foot%';</div><div class="line">hive&gt; select 1 from lxw_dual where 'football' like 'foot____';</div><div class="line">--注意：否定比较时候用NOT A LIKE B</div><div class="line">hive&gt; select 1 from lxw_dual where NOT 'football' like 'fff%';</div></pre></td></tr></table></figure>
</li>
<li><p>JAVA的LIKE操作: RLIKE<br>语法: A RLIKE B<br>操作类型: strings<br>描述: 如果字符串A或者字符串B为NULL，则返回NULL；如果字符串A符合JAVA正则表达式B的正则语法，则为TRUE；否则为FALSE。<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">hive&gt; select 1 from lxw_dual where 'footbar’ rlike '^f.*r$’;</div><div class="line">1</div><div class="line">--注意：判断一个字符串是否全为数字：</div><div class="line">hive&gt;select 1 from lxw_dual where '123456' rlike '^\\d+$';</div><div class="line">1</div><div class="line">hive&gt; select 1 from lxw_dual where '123456aa' rlike '^\\d+$';</div></pre></td></tr></table></figure>
</li>
<li><p>REGEXP操作: REGEXP<br>语法: A REGEXP B<br>操作类型: strings<br>描述: 功能与RLIKE相同<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hive&gt; select 1 from lxw_dual where 'footbar' REGEXP '^f.*r$';</div></pre></td></tr></table></figure>
</li>
</ol>
<p>二、数学运算：</p>
<ol>
<li><p>加法操作: +<br>语法: A + B<br>操作类型：所有数值类型<br>说明：返回A与B相加的结果。结果的数值类型等于A的类型和B的类型的最小父类型（详见数据类型的继承关系）。比如，int + int 一般结果为int类型，而int + double 一般结果为double类型<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">hive&gt; select 1 + 9 from lxw_dual;</div><div class="line">10</div><div class="line">hive&gt; create table lxw_dual as select 1 + 1.2 from lxw_dual;</div><div class="line">hive&gt; describe lxw_dual;</div><div class="line">_c0     double</div></pre></td></tr></table></figure>
</li>
<li><p>减法操作: -<br>语法: A – B<br>操作类型：所有数值类型<br>说明：返回A与B相减的结果。结果的数值类型等于A的类型和B的类型的最小父类型（详见数据类型的继承关系）。比如，int – int 一般结果为int类型，而int – double 一般结果为double类型<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">hive&gt; select 10 – 5 from lxw_dual;</div><div class="line">5</div><div class="line">hive&gt; create table lxw_dual as select 5.6 – 4 from lxw_dual;</div><div class="line">hive&gt; describe lxw_dual;</div><div class="line">_c0     double</div></pre></td></tr></table></figure>
</li>
<li><p>乘法操作: <em><br>语法: A </em> B<br>操作类型：所有数值类型<br>说明：返回A与B相乘的结果。结果的数值类型等于A的类型和B的类型的最小父类型（详见数据类型的继承关系）。注意，如果A乘以B的结果超过默认结果类型的数值范围，则需要通过cast将结果转换成范围更大的数值类型<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hive&gt; select 40 * 5 from lxw_dual;</div><div class="line">200</div></pre></td></tr></table></figure>
</li>
<li><p>除法操作: /<br>语法: A / B<br>操作类型：所有数值类型<br>说明：返回A除以B的结果。结果的数值类型为double<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hive&gt; select 40 / 5 from lxw_dual;</div><div class="line">8.0</div></pre></td></tr></table></figure>
</li>
</ol>
<p>注意：hive中最高精度的数据类型是double,只精确到小数点后16位，在做除法运算的时候要特别注意<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">hive&gt;select ceil(28.0/6.999999999999999999999) from lxw_dual limit 1;    </div><div class="line">结果为4</div><div class="line">hive&gt;select ceil(28.0/6.99999999999999) from lxw_dual limit 1;</div></pre></td></tr></table></figure></p>
<p>结果为5</p>
<ol>
<li><p>取余操作: %<br>语法: A % B<br>操作类型：所有数值类型<br>说明：返回A除以B的余数。结果的数值类型等于A的类型和B的类型的最小父类型（详见数据类型的继承关系）。<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">hive&gt; select 41 % 5 from lxw_dual;</div><div class="line">1</div><div class="line">hive&gt; select 8.4 % 4 from lxw_dual;</div><div class="line">0.40000000000000036</div><div class="line">注意：精度在hive中是个很大的问题，类似这样的操作最好通过round指定精度</div><div class="line">hive&gt; select round(8.4 % 4 , 2) from lxw_dual;</div><div class="line">0.4</div></pre></td></tr></table></figure>
</li>
<li><p>位与操作: &amp;<br>语法: A &amp; B<br>操作类型：所有数值类型<br>说明：返回A和B按位进行与操作的结果。结果的数值类型等于A的类型和B的类型的最小父类型（详见数据类型的继承关系）。<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">hive&gt; select 4 &amp; 8 from lxw_dual;</div><div class="line">0</div><div class="line">hive&gt; select 6 &amp; 4 from lxw_dual;</div><div class="line">4</div></pre></td></tr></table></figure>
</li>
<li><p>位或操作: |<br>语法: A | B<br>操作类型：所有数值类型<br>说明：返回A和B按位进行或操作的结果。结果的数值类型等于A的类型和B的类型的最小父类型（详见数据类型的继承关系）。<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">hive&gt; select 4 | 8 from lxw_dual;</div><div class="line">12</div><div class="line">hive&gt; select 6 | 8 from lxw_dual;</div><div class="line">14</div></pre></td></tr></table></figure>
</li>
<li><p>位异或操作: ^<br>语法: A ^ B<br>操作类型：所有数值类型<br>说明：返回A和B按位进行异或操作的结果。结果的数值类型等于A的类型和B的类型的最小父类型（详见数据类型的继承关系）。<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">hive&gt; select 4 ^ 8 from lxw_dual;</div><div class="line">12</div><div class="line">hive&gt; select 6 ^ 4 from lxw_dual;</div><div class="line">2</div></pre></td></tr></table></figure>
</li>
</ol>
<p>9．位取反操作: ~<br>语法: ~A<br>操作类型：所有数值类型<br>说明：返回A按位取反操作的结果。结果的数值类型等于A的类型。<br>举例：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">hive&gt; select ~6 from lxw_dual;</div><div class="line">-7</div><div class="line">hive&gt; select ~4 from lxw_dual;</div><div class="line">-5</div></pre></td></tr></table></figure></p>
<p>三、逻辑运算：</p>
<ol>
<li><p>逻辑与操作: AND<br>语法: A AND B<br>操作类型：boolean<br>说明：如果A和B均为TRUE，则为TRUE；否则为FALSE。如果A为NULL或B为NULL，则为NULL<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hive&gt; select 1 from lxw_dual where 1=1 and 2=2;</div><div class="line">1</div></pre></td></tr></table></figure>
</li>
<li><p>逻辑或操作: OR<br>语法: A OR B<br>操作类型：boolean<br>说明：如果A为TRUE，或者B为TRUE，或者A和B均为TRUE，则为TRUE；否则为FALSE<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hive&gt; select 1 from lxw_dual where 1=2 or 2=2;</div><div class="line">1</div></pre></td></tr></table></figure>
</li>
<li><p>逻辑非操作: NOT<br>语法: NOT A<br>操作类型：boolean<br>说明：如果A为FALSE，或者A为NULL，则为TRUE；否则为FALSE<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hive&gt; select 1 from lxw_dual where not 1=2;</div><div class="line">1</div></pre></td></tr></table></figure>
</li>
</ol>
<p>四、数值计算</p>
<ol>
<li><p>取整函数: round<br>语法: round(double a)<br>返回值: BIGINT<br>说明: 返回double类型的整数值部分 （遵循四舍五入）<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">hive&gt; select round(3.1415926) from lxw_dual;</div><div class="line">3</div><div class="line">hive&gt; select round(3.5) from lxw_dual;</div><div class="line">4</div><div class="line">hive&gt; create table lxw_dual as select round(9542.158) from lxw_dual;</div><div class="line">hive&gt; describe lxw_dual;</div><div class="line">_c0     bigint</div></pre></td></tr></table></figure>
</li>
<li><p>指定精度取整函数: round<br>语法: round(double a, int d)<br>返回值: DOUBLE<br>说明: 返回指定精度d的double类型<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hive&gt; select round(3.1415926,4) from lxw_dual;</div><div class="line">3.1416</div></pre></td></tr></table></figure>
</li>
<li><p>向下取整函数: floor<br>语法: floor(double a)<br>返回值: BIGINT<br>说明: 返回等于或者小于该double变量的最大的整数<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">hive&gt; select floor(3.1415926) from lxw_dual;</div><div class="line">3</div><div class="line">hive&gt; select floor(25) from lxw_dual;</div><div class="line">25</div></pre></td></tr></table></figure>
</li>
<li><p>向上取整函数: ceil<br>语法: ceil(double a)<br>返回值: BIGINT<br>说明: 返回等于或者大于该double变量的最小的整数<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">hive&gt; select ceil(3.1415926) from lxw_dual;</div><div class="line">4</div><div class="line">hive&gt; select ceil(46) from lxw_dual;</div><div class="line">46</div></pre></td></tr></table></figure>
</li>
<li><p>向上取整函数: ceiling<br>语法: ceiling(double a)<br>返回值: BIGINT<br>说明: 与ceil功能相同<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">hive&gt; select ceiling(3.1415926) from lxw_dual;</div><div class="line">4</div><div class="line">hive&gt; select ceiling(46) from lxw_dual;</div><div class="line">46</div></pre></td></tr></table></figure>
</li>
<li><p>取随机数函数: rand<br>语法: rand(),rand(int seed)<br>返回值: double<br>说明: 返回一个0到1范围内的随机数。如果指定种子seed，则会等到一个稳定的随机数序列<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">hive&gt; select rand() from lxw_dual;</div><div class="line">0.5577432776034763</div><div class="line">hive&gt; select rand() from lxw_dual;</div><div class="line">0.6638336467363424</div><div class="line">hive&gt; select rand(100) from lxw_dual;</div><div class="line">0.7220096548596434</div><div class="line">hive&gt; select rand(100) from lxw_dual;</div><div class="line">0.7220096548596434</div></pre></td></tr></table></figure>
</li>
<li><p>自然指数函数: exp<br>语法: exp(double a)<br>返回值: double<br>说明: 返回自然对数e的a次方<br>举例：<br>hive&gt; select exp(2) from lxw_dual;<br>7.38905609893065<br>自然对数函数: ln<br>语法: ln(double a)<br>返回值: double<br>说明: 返回a的自然对数<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hive&gt; select ln(7.38905609893065) from lxw_dual;</div><div class="line">2.0</div></pre></td></tr></table></figure>
</li>
<li><p>以10为底对数函数: log10<br>语法: log10(double a)<br>返回值: double<br>说明: 返回以10为底的a的对数<br>举例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hive&gt; select log10(100) from lxw_dual;</div><div class="line">2.0</div></pre></td></tr></table></figure>
</li>
<li><p>以2为底对数函数: log2<br>语法: log2(double a)<br>返回值: double<br>说明: 返回以2为底的a的对数<br>举例：<br>hive&gt; select log2(8) from lxw_dual;<br>3.0</p>
</li>
<li><p>对数函数: log<br>语法: log(double base, double a)<br>返回值: double<br>说明: 返回以base为底的a的对数<br>举例：<br>hive&gt; select log(4,256) from lxw_dual;<br>4.0</p>
</li>
<li><p>幂运算函数: pow<br>语法: pow(double a, double p)<br>返回值: double<br>说明: 返回a的p次幂<br>举例：<br>hive&gt; select pow(2,4) from lxw_dual;<br>16.0</p>
</li>
<li><p>幂运算函数: power<br>语法: power(double a, double p)<br>返回值: double<br>说明: 返回a的p次幂,与pow功能相同<br>举例：<br>hive&gt; select power(2,4) from lxw_dual;<br>16.0</p>
</li>
<li><p>开平方函数: sqrt<br>语法: sqrt(double a)<br>返回值: double<br>说明: 返回a的平方根<br>举例：<br>hive&gt; select sqrt(16) from lxw_dual;<br>4.0</p>
</li>
<li><p>二进制函数: bin<br>语法: bin(BIGINT a)<br>返回值: string<br>说明: 返回a的二进制代码表示<br>举例：<br>hive&gt; select bin(7) from lxw_dual;<br>111</p>
</li>
<li><p>十六进制函数: hex<br>语法: hex(BIGINT a)<br>返回值: string<br>说明: 如果变量是int类型，那么返回a的十六进制表示；如果变量是string类型，则返回该字符串的十六进制表示<br>举例：<br>hive&gt; select hex(17) from lxw_dual;<br>11<br>hive&gt; select hex(‘abc’) from lxw_dual;<br>616263</p>
</li>
<li><p>反转十六进制函数: unhex<br>语法: unhex(string a)<br>返回值: string<br>说明: 返回该十六进制字符串所代码的字符串<br>举例：<br>hive&gt; select unhex(‘616263’) from lxw_dual;<br>abc<br>hive&gt; select unhex(‘11’) from lxw_dual;<br>-<br>hive&gt; select unhex(616263) from lxw_dual;<br>abc</p>
</li>
<li><p>进制转换函数: conv<br>语法: conv(BIGINT num, int from_base, int to_base)<br>返回值: string<br>说明: 将数值num从from_base进制转化到to_base进制<br>举例：<br>hive&gt; select conv(17,10,16) from lxw_dual;<br>11<br>hive&gt; select conv(17,10,2) from lxw_dual;<br>10001</p>
</li>
<li><p>绝对值函数: abs<br>语法: abs(double a)   abs(int a)<br>返回值: double        int<br>说明: 返回数值a的绝对值<br>举例：<br>hive&gt; select abs(-3.9) from lxw_dual;<br>3.9<br>hive&gt; select abs(10.9) from lxw_dual;<br>10.9</p>
</li>
<li><p>正取余函数: pmod<br>语法: pmod(int a, int b),pmod(double a, double b)<br>返回值: int double<br>说明: 返回正的a除以b的余数<br>举例：<br>hive&gt; select pmod(9,4) from lxw_dual;<br>1<br>hive&gt; select pmod(-9,4) from lxw_dual;<br>3</p>
</li>
<li><p>正弦函数: sin<br>语法: sin(double a)<br>返回值: double<br>说明: 返回a的正弦值<br>举例：<br>hive&gt; select sin(0.8) from lxw_dual;<br>0.7173560908995228</p>
</li>
<li><p>反正弦函数: asin<br>语法: asin(double a)<br>返回值: double<br>说明: 返回a的反正弦值<br>举例：<br>hive&gt; select asin(0.7173560908995228) from lxw_dual;<br>0.8</p>
</li>
<li><p>余弦函数: cos<br>语法: cos(double a)<br>返回值: double<br>说明: 返回a的余弦值<br>举例：<br>hive&gt; select cos(0.9) from lxw_dual;<br>0.6216099682706644</p>
</li>
<li><p>反余弦函数: acos<br>语法: acos(double a)<br>返回值: double<br>说明: 返回a的反余弦值<br>举例：<br>hive&gt; select acos(0.6216099682706644) from lxw_dual;<br>0.9</p>
</li>
<li>positive函数: positive<br>语法: positive(int a), positive(double a)<br>返回值: int double<br>说明: 返回a<br>举例：<br>hive&gt; select positive(-10) from lxw_dual;<br>-10<br>hive&gt; select positive(12) from lxw_dual;<br>12</li>
<li>negative函数: negative<br>语法: negative(int a), negative(double a)<br>返回值: int double<br>说明: 返回-a<br>举例：<br>hive&gt; select negative(-5) from lxw_dual;<br>5<br>hive&gt; select negative(8) from lxw_dual;<br>-8<br>五、日期函数</li>
<li>UNIX时间戳转日期函数: from_unixtime<br>语法: from_unixtime(bigint unixtime[, string format])<br>返回值: string<br>说明: 转化UNIX时间戳（从1970-01-01 00:00:00 UTC到指定时间的秒数）到当前时区的时间格式<br>举例：<br>hive&gt; select from_unixtime(1323308943,’yyyyMMdd’) from lxw_dual;<br>20111208</li>
<li>获取当前UNIX时间戳函数: unix_timestamp<br>语法: unix_timestamp()<br>返回值: bigint<br>说明: 获得当前时区的UNIX时间戳<br>举例：<br>hive&gt; select unix_timestamp() from lxw_dual;<br>1323309615</li>
<li>日期转UNIX时间戳函数: unix_timestamp<br>语法: unix_timestamp(string date)<br>返回值: bigint<br>说明: 转换格式为”yyyy-MM-dd HH:mm:ss”的日期到UNIX时间戳。如果转化失败，则返回0。<br>举例：<br>hive&gt; select unix_timestamp(‘2011-12-07 13:01:03’) from lxw_dual;<br>1323234063</li>
<li>指定格式日期转UNIX时间戳函数: unix_timestamp<br>语法: unix_timestamp(string date, string pattern)<br>返回值: bigint<br>说明: 转换pattern格式的日期到UNIX时间戳。如果转化失败，则返回0。<br>举例：<br>hive&gt; select unix_timestamp(‘20111207 13:01:03’,’yyyyMMdd HH:mm:ss’) from lxw_dual;<br>1323234063</li>
<li><p>日期时间转日期函数: to_date<br>语法: to_date(string timestamp)<br>返回值: string<br>说明: 返回日期时间字段中的日期部分。<br>举例：<br>hive&gt; select to_date(‘2011-12-08 10:03:01’) from lxw_dual;<br>2011-12-08</p>
</li>
<li><p>日期转年函数: year<br>语法: year(string date)<br>返回值: int<br>说明: 返回日期中的年。<br>举例：<br>hive&gt; select year(‘2011-12-08 10:03:01’) from lxw_dual;<br>2011<br>hive&gt; select year(‘2012-12-08’) from lxw_dual;<br>2012</p>
</li>
<li><p>日期转月函数: month<br>语法: month (string date)<br>返回值: int<br>说明: 返回日期中的月份。<br>举例：<br>hive&gt; select month(‘2011-12-08 10:03:01’) from lxw_dual;<br>12<br>hive&gt; select month(‘2011-08-08’) from lxw_dual;<br>8</p>
</li>
<li><p>日期转天函数: day<br>语法: day (string date)<br>返回值: int<br>说明: 返回日期中的天。<br>举例：<br>hive&gt; select day(‘2011-12-08 10:03:01’) from lxw_dual;<br>8<br>hive&gt; select day(‘2011-12-24’) from lxw_dual;<br>24</p>
</li>
<li><p>日期转小时函数: hour<br>语法: hour (string date)<br>返回值: int<br>说明: 返回日期中的小时。<br>举例：<br>hive&gt; select hour(‘2011-12-08 10:03:01’) from lxw_dual;<br>10</p>
</li>
<li><p>日期转分钟函数: minute<br>语法: minute (string date)<br>返回值: int<br>说明: 返回日期中的分钟。<br>举例：<br>hive&gt; select minute(‘2011-12-08 10:03:01’) from lxw_dual;<br>3</p>
</li>
<li><p>日期转秒函数: second<br>语法: second (string date)<br>返回值: int<br>说明: 返回日期中的秒。<br>举例：<br>hive&gt; select second(‘2011-12-08 10:03:01’) from lxw_dual;<br>1</p>
</li>
<li><p>日期转周函数: weekofyear<br>语法: weekofyear (string date)<br>返回值: int<br>说明: 返回日期在当前的周数。<br>举例：<br>hive&gt; select weekofyear(‘2011-12-08 10:03:01’) from lxw_dual;<br>49</p>
</li>
<li><p>日期比较函数: datediff<br>语法: datediff(string enddate, string startdate)<br>返回值: int<br>说明: 返回结束日期减去开始日期的天数。<br>举例：<br>hive&gt; select datediff(‘2012-12-08’,’2012-05-09’) from lxw_dual;<br>213</p>
</li>
<li><p>日期增加函数: date_add<br>语法: date_add(string startdate, int days)<br>返回值: string<br>说明: 返回开始日期startdate增加days天后的日期。<br>举例：<br>hive&gt; select date_add(‘2012-12-08’,10) from lxw_dual;<br>2012-12-18</p>
</li>
<li><p>日期减少函数: date_sub<br>语法: date_sub (string startdate, int days)<br>返回值: string<br>说明: 返回开始日期startdate减少days天后的日期。<br>举例：<br>hive&gt; select date_sub(‘2012-12-08’,10) from lxw_dual;<br>2012-11-28</p>
</li>
</ol>
<p>六、条件函数</p>
<ol>
<li><p>If函数: if<br>语法: if(boolean testCondition, T valueTrue, T valueFalseOrNull)<br>返回值: T<br>说明:  当条件testCondition为TRUE时，返回valueTrue；否则返回valueFalseOrNull<br>举例：<br>hive&gt; select if(1=2,100,200) from lxw_dual;<br>200<br>hive&gt; select if(1=1,100,200) from lxw_dual;<br>100</p>
</li>
<li><p>非空查找函数: COALESCE<br>语法: COALESCE(T v1, T v2, …)<br>返回值: T<br>说明:  返回参数中的第一个非空值；如果所有值都为NULL，那么返回NULL<br>举例：<br>hive&gt; select COALESCE(null,’100’,’50′) from lxw_dual;<br>100</p>
</li>
<li><p>条件判断函数：CASE<br>语法: CASE a WHEN b THEN c [WHEN d THEN e]* [ELSE f] END<br>返回值: T<br>说明：如果a等于b，那么返回c；如果a等于d，那么返回e；否则返回f<br>举例：<br>hive&gt; Select case 100 when 50 then ‘tom’ when 100 then ‘mary’ else ‘tim’ end from lxw_dual;<br>mary<br>hive&gt; Select case 200 when 50 then ‘tom’ when 100 then ‘mary’ else ‘tim’ end from lxw_dual;<br>tim</p>
</li>
<li><p>条件判断函数：CASE<br>语法: CASE WHEN a THEN b [WHEN c THEN d]* [ELSE e] END<br>返回值: T<br>说明：如果a为TRUE,则返回b；如果c为TRUE，则返回d；否则返回e<br>举例：<br>hive&gt; select case when 1=2 then ‘tom’ when 2=2 then ‘mary’ else ‘tim’ end from lxw_dual;<br>mary<br>hive&gt; select case when 1=1 then ‘tom’ when 2=2 then ‘mary’ else ‘tim’ end from lxw_dual;<br>tom</p>
</li>
</ol>
<p>七、字符串函数</p>
<ol>
<li><p>字符串长度函数：length<br>语法: length(string A)<br>返回值: int<br>说明：返回字符串A的长度<br>举例：<br>hive&gt; select length(‘abcedfg’) from lxw_dual;<br>7</p>
</li>
<li><p>字符串反转函数：reverse<br>语法: reverse(string A)<br>返回值: string<br>说明：返回字符串A的反转结果<br>举例：<br>hive&gt; select reverse(abcedfg’) from lxw_dual;<br>gfdecba</p>
</li>
<li><p>字符串连接函数：concat<br>语法: concat(string A, string B…)<br>返回值: string<br>说明：返回输入字符串连接后的结果，支持任意个输入字符串<br>举例：<br>hive&gt; select concat(‘abc’,’def’,’gh’) from lxw_dual;<br>abcdefgh</p>
</li>
<li><p>带分隔符字符串连接函数：concat_ws<br>语法: concat_ws(string SEP, string A, string B…)<br>返回值: string<br>说明：返回输入字符串连接后的结果，SEP表示各个字符串间的分隔符<br>举例：<br>hive&gt; select concat_ws(‘,’,’abc’,’def’,’gh’) from lxw_dual;<br>abc,def,gh</p>
</li>
<li><p>字符串截取函数：substr,substring<br>语法: substr(string A, int start),substring(string A, int start)<br>返回值: string<br>说明：返回字符串A从start位置到结尾的字符串<br>举例：<br>hive&gt; select substr(‘abcde’,3) from lxw_dual;<br>cde<br>hive&gt; select substring(‘abcde’,3) from lxw_dual;<br>cde<br>hive&gt;  select substr(‘abcde’,-1) from lxw_dual;  （和ORACLE相同）<br>e</p>
</li>
<li><p>字符串截取函数：substr,substring<br>语法: substr(string A, int start, int len),substring(string A, int start, int len)<br>返回值: string<br>说明：返回字符串A从start位置开始，长度为len的字符串<br>举例：<br>hive&gt; select substr(‘abcde’,3,2) from lxw_dual;<br>cd<br>hive&gt; select substring(‘abcde’,3,2) from lxw_dual;<br>cd<br>hive&gt;select substring(‘abcde’,-2,2) from lxw_dual;<br>de</p>
</li>
<li><p>字符串转大写函数：upper,ucase<br>语法: upper(string A) ucase(string A)<br>返回值: string<br>说明：返回字符串A的大写格式<br>举例：<br>hive&gt; select upper(‘abSEd’) from lxw_dual;<br>ABSED<br>hive&gt; select ucase(‘abSEd’) from lxw_dual;<br>ABSED</p>
</li>
<li><p>字符串转小写函数：lower,lcase<br>语法: lower(string A) lcase(string A)<br>返回值: string<br>说明：返回字符串A的小写格式<br>举例：<br>hive&gt; select lower(‘abSEd’) from lxw_dual;<br>absed<br>hive&gt; select lcase(‘abSEd’) from lxw_dual;<br>absed</p>
</li>
<li><p>去空格函数：trim<br>语法: trim(string A)<br>返回值: string<br>说明：去除字符串两边的空格<br>举例：<br>hive&gt; select trim(‘ abc ‘) from lxw_dual;<br>abc</p>
</li>
<li><p>左边去空格函数：ltrim<br>语法: ltrim(string A)<br>返回值: string<br>说明：去除字符串左边的空格<br>举例：<br>hive&gt; select ltrim(‘ abc ‘) from lxw_dual;<br>abc</p>
</li>
<li><p>右边去空格函数：rtrim<br>语法: rtrim(string A)<br>返回值: string<br>说明：去除字符串右边的空格<br>举例：<br>hive&gt; select rtrim(‘ abc ‘) from lxw_dual;<br>abc</p>
</li>
<li><p>正则表达式替换函数：regexp_replace<br>语法: regexp_replace(string A, string B, string C)<br>返回值: string<br>说明：将字符串A中的符合java正则表达式B的部分替换为C。注意，在有些情况下要使用转义字符,类似oracle中的regexp_replace函数。<br>举例：<br>hive&gt; select regexp_replace(‘foobar’, ‘oo|ar’, ‘’) from lxw_dual;<br>fb</p>
</li>
<li><p>正则表达式解析函数：regexp_extract<br>语法: regexp_extract(string subject, string pattern, int index)<br>返回值: string<br>说明：将字符串subject按照pattern正则表达式的规则拆分，返回index指定的字符。<br>举例：<br>hive&gt; select regexp_extract(‘foothebar’, ‘foo(.<em>?)(bar)’, 1) from lxw_dual;<br>the<br>hive&gt; select regexp_extract(‘foothebar’, ‘foo(.</em>?)(bar)’, 2) from lxw_dual;<br>bar<br>hive&gt; select regexp_extract(‘foothebar’, ‘foo(.<em>?)(bar)’, 0) from lxw_dual;<br>foothebar<br>注意，在有些情况下要使用转义字符，下面的等号要用双竖线转义，这是java正则表达式的规则。<br>select data_field,<br>regexp_extract(data_field,’.</em>?bgStart\=([^&amp;]+)’,1) as aaa,<br>regexp_extract(data_field,’.<em>?contentLoaded_headStart\=([^&amp;]+)’,1) as bbb,<br>regexp_extract(data_field,’.</em>?AppLoad2Req\=([^&amp;]+)’,1) as ccc<br>from pt_nginx_loginlog_st<br>where pt = ‘2012-03-26’ limit 2;</p>
</li>
<li><p>URL解析函数：parse_url<br>语法: parse_url(string urlString, string partToExtract [, string keyToExtract])<br>返回值: string<br>说明：返回URL中指定的部分。partToExtract的有效值为：HOST, PATH, QUERY, REF, PROTOCOL, AUTHORITY, FILE, and USERINFO.<br>举例：<br>hive&gt; select parse_url(‘<a href="http://facebook.com/path1/p.php?k1=v1&amp;k2=v2#Ref1" target="_blank" rel="external">http://facebook.com/path1/p.php?k1=v1&amp;k2=v2#Ref1</a>‘, ‘HOST’) from lxw_dual;<br>facebook.com<br>hive&gt; select parse_url(‘<a href="http://facebook.com/path1/p.php?k1=v1&amp;k2=v2#Ref1" target="_blank" rel="external">http://facebook.com/path1/p.php?k1=v1&amp;k2=v2#Ref1</a>‘, ‘QUERY’, ‘k1’) from lxw_dual;<br>v1</p>
</li>
<li><p>json解析函数：get_json_object<br>语法: get_json_object(string json_string, string path)<br>返回值: string<br>说明：解析json的字符串json_string,返回path指定的内容。如果输入的json字符串无效，那么返回NULL。<br>举例：<br>hive&gt; select  get_json_object(‘{“store”:</p>
<blockquote>
<p>  {“fruit”:[{“weight”:8,”type”:”apple”},{“weight”:9,”type”:”pear”}],<br>   “bicycle”:{“price”:19.95,”color”:”red”}<br>  },<br> “email”:”amy@only_for_json_udf_test.net”,<br> “owner”:”amy”<br>}<br>‘,’$.owner’) from lxw_dual;<br>amy</p>
</blockquote>
</li>
<li><p>空格字符串函数：space<br>语法: space(int n)<br>返回值: string<br>说明：返回长度为n的字符串<br>举例：<br>hive&gt; select space(10) from lxw_dual;<br>hive&gt; select length(space(10)) from lxw_dual;<br>10</p>
</li>
<li><p>重复字符串函数：repeat<br>语法: repeat(string str, int n)<br>返回值: string<br>说明：返回重复n次后的str字符串<br>举例：<br>hive&gt; select repeat(‘abc’,5) from lxw_dual;<br>abcabcabcabcabc</p>
</li>
<li><p>首字符ascii函数：ascii<br>语法: ascii(string str)<br>返回值: int<br>说明：返回字符串str第一个字符的ascii码<br>举例：<br>hive&gt; select ascii(‘abcde’) from lxw_dual;<br>97</p>
</li>
<li><p>左补足函数：lpad<br>语法: lpad(string str, int len, string pad)<br>返回值: string<br>说明：将str进行用pad进行左补足到len位<br>举例：<br>hive&gt; select lpad(‘abc’,10,’td’) from lxw_dual;<br>tdtdtdtabc<br>注意：与GP，ORACLE不同，pad 不能默认</p>
</li>
<li><p>右补足函数：rpad<br>语法: rpad(string str, int len, string pad)<br>返回值: string<br>说明：将str进行用pad进行右补足到len位<br>举例：<br>hive&gt; select rpad(‘abc’,10,’td’) from lxw_dual;<br>abctdtdtdt</p>
</li>
<li><p>分割字符串函数: split<br>语法:  split(string str, string pat)<br>返回值:  array<br>说明: 按照pat字符串分割str，会返回分割后的字符串数组<br>举例：<br>hive&gt; select split(‘abtcdtef’,’t’) from lxw_dual;<br>[“ab”,”cd”,”ef”]</p>
</li>
<li><p>集合查找函数: find_in_set<br>语法: find_in_set(string str, string strList)<br>返回值: int<br>说明: 返回str在strlist第一次出现的位置，strlist是用逗号分割的字符串。如果没有找该str字符，则返回0<br>举例：<br>hive&gt; select find_in_set(‘ab’,’ef,ab,de’) from lxw_dual;<br>2<br>hive&gt; select find_in_set(‘at’,’ef,ab,de’) from lxw_dual;<br>0</p>
</li>
</ol>
<p>八、集合统计函数</p>
<ol>
<li><p>个数统计函数: count<br>语法: count(<em>), count(expr), count(DISTINCT expr[, expr_.])<br>返回值: int<br>说明: count(</em>)统计检索出的行的个数，包括NULL值的行；count(expr)返回指定字段的非空值的个数；count(DISTINCT expr[, expr_.])返回指定字段的不同的非空值的个数<br>举例：<br>hive&gt; select count(*) from lxw_dual;<br>20<br>hive&gt; select count(distinct t) from lxw_dual;<br>10</p>
</li>
<li><p>总和统计函数: sum<br>语法: sum(col), sum(DISTINCT col)<br>返回值: double<br>说明: sum(col)统计结果集中col的相加的结果；sum(DISTINCT col)统计结果中col不同值相加的结果<br>举例：<br>hive&gt; select sum(t) from lxw_dual;<br>100<br>hive&gt; select sum(distinct t) from lxw_dual;<br>70</p>
</li>
<li><p>平均值统计函数: avg<br>语法: avg(col), avg(DISTINCT col)<br>返回值: double<br>说明: avg(col)统计结果集中col的平均值；avg(DISTINCT col)统计结果中col不同值相加的平均值<br>举例：<br>hive&gt; select avg(t) from lxw_dual;<br>50<br>hive&gt; select avg (distinct t) from lxw_dual;<br>30</p>
</li>
<li><p>最小值统计函数: min<br>语法: min(col)<br>返回值: double<br>说明: 统计结果集中col字段的最小值<br>举例：<br>hive&gt; select min(t) from lxw_dual;<br>20</p>
</li>
<li><p>最大值统计函数: max<br>语法: maxcol)<br>返回值: double<br>说明: 统计结果集中col字段的最大值<br>举例：<br>hive&gt; select max(t) from lxw_dual;<br>120</p>
</li>
<li><p>非空集合总体变量函数: var_pop<br>语法: var_pop(col)<br>返回值: double<br>说明: 统计结果集中col非空集合的总体变量（忽略null）<br>举例：</p>
</li>
<li><p>非空集合样本变量函数: var_samp<br>语法: var_samp (col)<br>返回值: double<br>说明: 统计结果集中col非空集合的样本变量（忽略null）<br>举例：</p>
</li>
<li><p>总体标准偏离函数: stddev_pop<br>语法: stddev_pop(col)<br>返回值: double<br>说明: 该函数计算总体标准偏离，并返回总体变量的平方根，其返回值与VAR_POP函数的平方根相同<br>举例：</p>
</li>
<li><p>样本标准偏离函数: stddev_samp<br>语法: stddev_samp (col)<br>返回值: double<br>说明: 该函数计算样本标准偏离<br>举例：</p>
</li>
</ol>
<p>10．中位数函数: percentile<br>语法: percentile(BIGINT col, p)<br>返回值: double<br>说明: 求准确的第pth个百分位数，p必须介于0和1之间，但是col字段目前只支持整数，不支持浮点数类型<br>举例：</p>
<ol>
<li><p>中位数函数: percentile<br>语法: percentile(BIGINT col, array(p1 [, p2]…))<br>返回值: array<double><br>说明: 功能和上述类似，之后后面可以输入多个百分位数，返回类型也为array<double>，其中为对应的百分位数。<br>举例：<br>select percentile(score,<0.2,0.4>) from lxw_dual； 取0.2，0.4位置的数据</0.2,0.4></double></double></p>
</li>
<li><p>近似中位数函数: percentile_approx<br>语法: percentile_approx(DOUBLE col, p [, B])<br>返回值: double<br>说明: 求近似的第pth个百分位数，p必须介于0和1之间，返回类型为double，但是col字段支持浮点类型。参数B控制内存消耗的近似精度，B越大，结果的准确度越高。默认为10,000。当col字段中的distinct值的个数小于B时，结果为准确的百分位数<br>举例：</p>
</li>
<li><p>近似中位数函数: percentile_approx<br>语法: percentile_approx(DOUBLE col, array(p1 [, p2]…) [, B])<br>返回值: array<double><br>说明: 功能和上述类似，之后后面可以输入多个百分位数，返回类型也为array<double>，其中为对应的百分位数。<br>举例：</double></double></p>
</li>
<li><p>直方图: histogram_numeric<br>语法: histogram_numeric(col, b)<br>返回值: array<struct {‘x’,‘y’}=""><br>说明: 以b为基准计算col的直方图信息。<br>举例：<br>hive&gt; select histogram_numeric(100,5) from lxw_dual;<br>[{“x”:100.0,”y”:1.0}]</struct></p>
</li>
</ol>
<p>九、复合类型构建操作</p>
<ol>
<li><p>Map类型构建: map<br>语法: map (key1, value1, key2, value2, …)<br>说明：根据输入的key和value对构建map类型<br>举例：<br>hive&gt; Create table lxw_test as select map(‘100’,’tom’,’200’,’mary’) as t from lxw_dual;<br>hive&gt; describe lxw_test;<br>t       map<string,string><br>hive&gt; select t from lxw_test;<br>{“100”:”tom”,”200”:”mary”}</string,string></p>
</li>
<li><p>Struct类型构建: struct<br>语法: struct(val1, val2, val3, …)<br>说明：根据输入的参数构建结构体struct类型<br>举例：<br>hive&gt; create table lxw_test as select struct(‘tom’,’mary’,’tim’) as t from lxw_dual;<br>hive&gt; describe lxw_test;<br>t       struct<col1:string,col2:string,col3:string><br>hive&gt; select t from lxw_test;<br>{“col1”:”tom”,”col2”:”mary”,”col3”:”tim”}</col1:string,col2:string,col3:string></p>
</li>
<li><p>array类型构建: array<br>语法: array(val1, val2, …)<br>说明：根据输入的参数构建数组array类型<br>举例：<br>hive&gt; create table lxw_test as select array(“tom”,”mary”,”tim”) as t from lxw_dual;<br>hive&gt; describe lxw_test;<br>t       array<string><br>hive&gt; select t from lxw_test;<br>[“tom”,”mary”,”tim”]</string></p>
</li>
</ol>
<p>十、复杂类型访问操作</p>
<ol>
<li><p>array类型访问: A[n]<br>语法: A[n]<br>操作类型: A为array类型，n为int类型<br>说明：返回数组A中的第n个变量值。数组的起始下标为0。比如，A是个值为[‘foo’, ‘bar’]的数组类型，那么A[0]将返回’foo’,而A[1]将返回’bar’<br>举例：<br>hive&gt; create table lxw_test as select array(“tom”,”mary”,”tim”) as t from lxw_dual;<br>hive&gt; select t[0],t[1],t[2] from lxw_test;<br>tom     mary    tim</p>
</li>
<li><p>map类型访问: M[key]<br>语法: M[key]<br>操作类型: M为map类型，key为map中的key值<br>说明：返回map类型M中，key值为指定值的value值。比如，M是值为{‘f’ -&gt; ‘foo’, ‘b’ -&gt; ‘bar’, ‘all’ -&gt; ‘foobar’}的map类型，那么M[‘all’]将会返回’foobar’<br>举例：<br>hive&gt; Create table lxw_test as select map(‘100’,’tom’,’200’,’mary’) as t from lxw_dual;<br>hive&gt; select t[‘200’],t[‘100’] from lxw_test;<br>mary    tom</p>
</li>
<li><p>struct类型访问: S.x<br>语法: S.x<br>操作类型: S为struct类型<br>说明：返回结构体S中的x字段。比如，对于结构体struct foobar {int foo, int bar}，foobar.foo返回结构体中的foo字段<br>举例：<br>hive&gt; create table lxw_test as select struct(‘tom’,’mary’,’tim’) as t from lxw_dual;<br>hive&gt; describe lxw_test;<br>t       struct<col1:string,col2:string,col3:string><br>hive&gt; select t.col1,t.col3 from lxw_test;<br>tom     tim</col1:string,col2:string,col3:string></p>
</li>
</ol>
<p>十一、复杂类型长度统计函数</p>
<ol>
<li><p>Map类型长度函数: size(Map<k.v>)<br>语法: size(Map<k.v>)<br>返回值: int<br>说明: 返回map类型的长度<br>举例：<br>hive&gt; select size(map(‘100’,’tom’,’101’,’mary’)) from lxw_dual;<br>2</k.v></k.v></p>
</li>
<li><p>array类型长度函数: size(Array<t>)<br>语法: size(Array<t>)<br>返回值: int<br>说明: 返回array类型的长度<br>举例：<br>hive&gt; select size(array(‘100’,’101’,’102’,’103’)) from lxw_dual;<br>4</t></t></p>
</li>
<li><p>类型转换函数<br>类型转换函数: cast<br>语法: cast(expr as <type>)<br>返回值: Expected “=” to follow “type”<br>说明: 返回array类型的长度<br>举例：<br>hive&gt; select cast(1 as bigint) from lxw_dual;<br>1</type></p>
</li>
</ol>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/04/18/2017-04-18-hive-learn/" rel="next" title="hive知识点总结">
                <i class="fa fa-chevron-left"></i> hive知识点总结
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2017/04/18/2017-04-18-hive-function/"
           data-title="hive函数大全" data-url="http://crystal564.github.io/2017/04/18/2017-04-18-hive-function/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="crystal564" />
          <p class="site-author-name" itemprop="name">crystal564</p>
           
              <p class="site-description motion-element" itemprop="description">记录生活点滴</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">7</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">crystal564</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"crystal564"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  













  
  

  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("4kCEAwaczLto7YeJJkO6YSv8-gzGzoHsz", "lf4I3poOdeuRfChe3OjjeUqv");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  


  

</body>
</html>
